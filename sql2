WITH matched_tables AS (
    SELECT 
        table_schema,
        table_name
    FROM 
        information_schema.tables
    WHERE 
        table_type = 'BASE TABLE' -- 普通用户表
        AND table_name ILIKE ANY (ARRAY['%floating%', '%ljx%', '%szjt%']) -- 匹配表名
)
SELECT 
    table_schema || '.' || table_name AS full_table_name,
    pg_size_pretty(pg_total_relation_size(table_schema || '.' || table_name)) AS table_size, -- 表大小
    (SELECT COUNT(*) FROM information_schema.columns 
        WHERE table_schema = mt.table_schema AND table_name = mt.table_name) AS column_count, -- 列数
    (SELECT COUNT(*) FROM mt.table_schema || '.' || mt.table_name) AS row_count -- 行数
FROM 
    matched_tables mt
ORDER BY 
    pg_total_relation_size(table_schema || '.' || table_name) DESC; -- 按表大小排序
